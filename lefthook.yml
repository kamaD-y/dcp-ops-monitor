pre-commit:
  parallel: true
  commands:
    check:
      glob: "*.{js,ts,cjs,mjs,d.cts,d.mts,jsx,tsx,json,jsonc}"
      run: npx biome check --no-errors-on-unmatched --files-ignore-unknown=true --colors=off {staged_files}

    test:cdk:
      glob:
        - "bin/*.{ts,js}"
        - "lib/*.{ts,js}"
        - "lambda/**/*.py"
      run: npm run test:cdk

    lint:lambda:
      glob: "lambda/**/*.py"
      run: uvx ruff check --no-fix

    format:lambda:
      glob: "lambda/**/*.py"
      run: uvx ruff format --check

    type-check:lambda:
      glob: "lambda/**/*.py"
      run: npm run type-check

    test:web-scraping:
      glob: "lambda/web-scraping/**/*.py"
      run: cd lambda/web-scraping && ENV=test uv run pytest --cov -v --tb=short --disable-warnings --maxfail=1

    test:error-notification:
      glob: "lambda/error-notification/**/*.py"
      run: cd lambda/error-notification && ENV=test uv run pytest --cov -v --tb=short --disable-warnings --maxfail=1

    test:summary-notification:
      glob: "lambda/summary-notification/**/*.py"
      run: cd lambda/summary-notification && ENV=test uv run pytest --cov -v --tb=short --disable-warnings --maxfail=1
